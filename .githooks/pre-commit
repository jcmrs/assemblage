#!/bin/sh
#
# This hook executes the Python-based pre-commit logic.

echo "--- Running Assemblage Pre-Commit Hook ---"

# Ensure we are using the project's virtual environment if it exists
if [ -d ".venv" ]; then
    # This works for both Windows (Git Bash) and Linux/macOS
    source .venv/bin/activate
fi

# Execute the Python script
python -m assemblage.tools.pre_commit_hook

# Capture the exit code from the Python script
EXIT_CODE=$?

if [ $EXIT_CODE -ne 0 ]; then
    echo "--- Pre-Commit Check FAILED. Aborting commit. ---" >&2
    exit 1
else
    echo "--- Pre-Commit Check PASSED. ---"
fi

exit 0